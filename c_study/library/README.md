# 动态库和静态库
静态链接库与动态链接库都是共享代码的方式

## 概念介绍
### 静态链接  
静态链接就是编译器在编译可执行文件的时候,将可执行文件需要调用的对应静态链接库(.a)中的目标文件(object file)提取出来,链接到可执行文件中去,使可执行文件在运行的时候不依赖于静态链接库

### 动态链接  
加载动态链接库,首先为动态链接分配物理内存,然后在进程对应的页表项中建立虚拟页和物理页面之间的映射。系统中存在一种引用计数机制,每当一个进程加载了动态库(在该进程的页表中进行一次映射)引用计数+1,当一个进程显式卸载(通过dlclose等)共享库或进程退出时引用计数-1,当减少到0时,系统卸载共享库。
动态编译的可执行文件需要附带一个动态链接库。在执行时,需要调用其对应动态链接库中的代码。所以其优点一方面是缩小了可执行文件本身的体积,另一方面是加快了编译速度,节省了系统资源。缺点一是哪怕是很简单的程序,只用到了链接库中的一两条命令,也需要附带一个相对庞大的链接库;二是如果其他计算机上没有安装对应的运行库,则用动态编译的可执行文件就不能运行。


### 静态链接库 
静态链接库就是把目标文件(object file)压缩(archive)到一起,生成 .a 后缀的压缩包

### 动态链接库 
动态链接库就是把目标文件(object file)链接在一起生成位置独立代码。

### 静态链接库和动态链接库的区别  
静态链接库中不能再包含其他的动态链接库或者静态库,而在动态链接库中还可以再包含其他的动态或静态链接库


## 链接动态库或静态库
linux 默认的依赖库搜索路径: /lib  /usr/lib

使用-L指定依赖库搜索路径
gcc main.c -o main -L./ -lmymath
在 ./ 目录下链接 libmymath.so或libmymath.a,当目录下同时有静态库和动态库时,优先链接动态库. 

C语言系统默认依赖库是 /usr/lib 下的 libc.so和libc.a,如果用到的C系统函数没有在libc.so或libc.a中,需要指定要链接的库.
如下:
#include <math.h>       需要链接libm.so或libm.a  编译时指定要链接的库 -lm
#include <dlfcn.h>      编译时指定要链接的库 -ldl
